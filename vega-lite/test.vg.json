{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Slope chart showing changes in ind_source by state from 2015 to 2022",
  "width": 600,
  "height": 500,
  "data": {
    "values": [
      {"state": "Selangor", "ind_source": 2949, "year": 2022},
      {"state": "Johor", "ind_source": 2422, "year": 2022},
      {"state": "Perak", "ind_source": 1586, "year": 2022},
      {"state": "Pulau Pinang", "ind_source": 1339, "year": 2022},
      {"state": "Kedah", "ind_source": 1020, "year": 2022},
      {"state": "Sabah", "ind_source": 799, "year": 2022},
      {"state": "Pahang", "ind_source": 536, "year": 2022},
      {"state": "Negeri Sembilan", "ind_source": 523, "year": 2022},
      {"state": "Sarawak", "ind_source": 1391, "year": 2022},
      {"state": "Kelantan", "ind_source": 348, "year": 2022},
      {"state": "Terengganu", "ind_source": 349, "year": 2022},
      {"state": "Wilayah Persekutuan", "ind_source": 383, "year": 2022},
      {"state": "Melaka", "ind_source": 273, "year": 2022},
      {"state": "Perlis", "ind_source": 51, "year": 2022},
      {"state": "Selangor", "ind_source": 2995, "year": 2015},
      {"state": "Johor", "ind_source": 2325, "year": 2015},
      {"state": "Sarawak", "ind_source": 1633, "year": 2015},
      {"state": "Perak", "ind_source": 1516, "year": 2015},
      {"state": "Pulau Pinang", "ind_source": 1205, "year": 2015},
      {"state": "Kedah", "ind_source": 1013, "year": 2015},
      {"state": "Sabah", "ind_source": 751, "year": 2015},
      {"state": "Negeri Sembilan", "ind_source": 495, "year": 2015},
      {"state": "Pahang", "ind_source": 489, "year": 2015},
      {"state": "Wilayah Persekutuan", "ind_source": 520, "year": 2015},
      {"state": "Melaka", "ind_source": 408, "year": 2015},
      {"state": "Terengganu", "ind_source": 397, "year": 2015},
      {"state": "Kelantan", "ind_source": 325, "year": 2015},
      {"state": "Perlis", "ind_source": 52, "year": 2015}
    ]
  },
  "transform": [
    {
      "calculate": "datum.year == 2015 ? '2015' : '2022'",
      "as": "year_label"
    }
  ],
  "layer": [
    {
      "mark": {
        "type": "line",
        "strokeWidth": 2,
        "opacity": 0.6
      },
      "encoding": {
        "x": {
          "field": "year",
          "type": "ordinal",
          "axis": {
            "title": null,
            "labelAngle": 0,
            "labelFontSize": 14
          },
          "scale": {"padding": 0.5}
        },
        "y": {
          "field": "ind_source",
          "type": "quantitative",
          "axis": {"title": "Industrial Source"}
        },
        "detail": {"field": "state", "type": "nominal"},
        "color": {
          "condition": {
            "test": "datum.state == 'Selangor' || datum.state == 'Johor' || datum.state == 'Sarawak'",
            "value": "#FF6B6B"
          },
          "value": "#4682B4"
        },
        "tooltip": [
          {"field": "state", "type": "nominal", "title": "State"},
          {"field": "year", "type": "ordinal", "title": "Year"},
          {"field": "ind_source", "type": "quantitative", "title": "Value"}
        ]
      }
    },
    {
      "mark": {
        "type": "point",
        "size": 100,
        "filled": true
      },
      "encoding": {
        "x": {"field": "year", "type": "ordinal"},
        "y": {"field": "ind_source", "type": "quantitative"},
        "color": {
          "condition": {
            "test": "datum.state == 'Selangor' || datum.state == 'Johor' || datum.state == 'Sarawak'",
            "value": "#FF6B6B"
          },
          "value": "#4682B4"
        },
        "tooltip": [
          {"field": "state", "type": "nominal", "title": "State"},
          {"field": "year", "type": "ordinal", "title": "Year"},
          {"field": "ind_source", "type": "quantitative", "title": "Value"}
        ]
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "right",
        "dx": -8,
        "fontSize": 10
      },
      "encoding": {
        "x": {"field": "year", "type": "ordinal"},
        "y": {"field": "ind_source", "type": "quantitative"},
        "text": {"field": "state", "type": "nominal"},
        "opacity": {
          "condition": {
            "test": "datum.year == 2015",
            "value": 1
          },
          "value": 0
        }
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "dx": 8,
        "fontSize": 10
      },
      "encoding": {
        "x": {"field": "year", "type": "ordinal"},
        "y": {"field": "ind_source", "type": "quantitative"},
        "text": {"field": "state", "type": "nominal"},
        "opacity": {
          "condition": {
            "test": "datum.year == 2022",
            "value": 1
          },
          "value": 0
        }
      }
    }
  ]
}